<!DOCTYPE html><html lang="ch-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>操作系统笔记 | Lilijiu'blog</title><script>var config = </script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.1.0"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg);"><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><main><header><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem"><a href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>操作系统笔记</h1><div id="post-info"><span>First Post:<span class="control"><time datetime="2022-03-25T12:48:32.000Z" id="date"> 2022-03-25</time></span></span><br><span>Last Update:<span class="control"><time datetime="2022-03-28T15:28:10.950Z" id="updated"> 2022-03-28</time></span></span></div></div><hr><div id="post-content"><p><em>为了看得懂期末试卷，加油吧，诸君！</em>(英文试卷，中英文作答皆可)</p>
<p><em>老师说上一届挂科率为20%左右（海底捞之后）</em></p>
<p>book: 《Modern Operating System》(Fourth Edition)<br>ppt: from Li Hang – Xi Dian University</p>
<h1 id="一-绪论"><a href="#一-绪论" class="headerlink" title="一.绪论"></a>一.绪论</h1><h1 id="二-PROCESSES-AND-THREADS"><a href="#二-PROCESSES-AND-THREADS" class="headerlink" title="二.PROCESSES    AND     THREADS"></a>二.PROCESSES    AND     THREADS</h1><h2 id="PROCESSES"><a href="#PROCESSES" class="headerlink" title="PROCESSES"></a>PROCESSES</h2><p><img src="http://r9d5zu5jl.bkt.clouddn.com/image-20220326224247358.png" alt="process studying"></p>
<h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><p>​        <em>an abstracting of a running program</em> </p>
<p>or </p>
<p>​        <em>A process is just an instance of an executing program</em></p>
<h3 id="Internal-structure"><a href="#Internal-structure" class="headerlink" title="Internal structure"></a>Internal structure</h3><p>​        Code Segment、Stack Segment、Data Segment</p>
<h3 id="Address-Space"><a href="#Address-Space" class="headerlink" title="Address Space"></a>Address Space</h3><p>​        一堆连续地址的集合且一般情况下，进程与进程间的地址空间是互相独立的</p>
<p>​        Kernel Space(3G — 4G-1) &amp; User Space(0 — 3G-1)</p>
<h3 id="PCB-Process-Control-Block"><a href="#PCB-Process-Control-Block" class="headerlink" title="PCB(Process Control Block)"></a>PCB(<em>Process Control Block</em>)</h3><h4 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h4><p>​    Process management、Memory management、File management</p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/PCB.png" alt="PCB"></p>
<h3 id="Process-Model"><a href="#Process-Model" class="headerlink" title="Process Model"></a>Process Model</h3><p><img src="http://r9d5zu5jl.bkt.clouddn.com/VQ%24%5D02MQ~%60G8%60%60Y4URZKB5T.png" alt="process model"></p>
<h3 id="Process-States"><a href="#Process-States" class="headerlink" title="Process States"></a>Process States</h3><p>​            <em>这张图常考</em></p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/States.png" alt="States"></p>
<h3 id="Process-Creation"><a href="#Process-Creation" class="headerlink" title="Process Creation"></a>Process Creation</h3><p>​        System initialization.</p>
<p>​        Execution of a process creation system call by a running process.</p>
<p>​        A user request to create a new process.</p>
<p>​        Initiation of a batch job.</p>
<p>以下是两个例子：</p>
<h6 id="fork函数点击→fork←点击"><a href="#fork函数点击→fork←点击" class="headerlink" title="fork函数点击→fork←点击"></a>fork函数<a target="_blank" rel="noopener" href="https://blog.csdn.net/kxjrzyk/article/details/81603049?utm_source=app&app_version=5.2.1&code=app_1562916241&uLinkId=usr1mkqgl919blen">点击→fork←点击</a></h6><p><img src="http://r9d5zu5jl.bkt.clouddn.com/fork.png" alt="课堂例子"></p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/fork%E7%BB%93%E6%9E%9C.png" alt="fork结果"></p>
<h6 id="excel函数exec族函数详解"><a href="#excel函数exec族函数详解" class="headerlink" title="excel函数exec族函数详解"></a>excel函数<a target="_blank" rel="noopener" href="http://www.jb51.net/article/71734.htm">exec族函数详解</a></h6><p><img src="http://r9d5zu5jl.bkt.clouddn.com/execl.png" alt="excel"></p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/execl%E7%BB%93%E6%9E%9C.png" alt="excel-result"></p>
<p>​    exce族函数和fork函数都是Linux系统中对于进程的操作函数，都相当于是以“Execution of a process creation system call by a running process.”的方式创造进程，区别是：</p>
<p>​    fork：过系统调用创建一个与原来进程几乎完全相同的进程,也就是子进程。</p>
<p>​    execl：用指定程序的代码段和数据段覆盖现有的代码段与数据段，并重新初始化，从头开始执行。</p>
<h3 id="Process-Termination"><a href="#Process-Termination" class="headerlink" title="Process Termination"></a>Process Termination</h3><p>​        Normal exit (voluntary)</p>
<p>​        Error exit (voluntary)</p>
<p>​        Fatal error (involuntary)</p>
<p>​        Killed by another process (involuntary)</p>
<h3 id="Process-Switching"><a href="#Process-Switching" class="headerlink" title="Process Switching"></a>Process Switching</h3><p>​        进程的切换一般从时钟中断开始</p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/%E8%BF%9B%E7%A8%8B%E5%88%87%E6%8D%A2.png" alt="进程切换"></p>
<h3 id="Process-Performance-Measurement"><a href="#Process-Performance-Measurement" class="headerlink" title="Process Performance Measurement"></a>Process Performance Measurement</h3><p><img src="http://r9d5zu5jl.bkt.clouddn.com/CPU%E5%88%A9%E7%94%A8%E7%8E%87.png" alt="CPU利用率"></p>
<p>p:某个进程做I&#x2F;O的概率</p>
<h2 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h2><h3 id="Definition-1"><a href="#Definition-1" class="headerlink" title="Definition"></a>Definition</h3><p>课本：<em>lightweight process</em>（考试优先选择）</p>
<p>老师总结：进程中一个的代码片段，改代码片段可以和进程中的其他代码片段并发运行。</p>
<p><em>线程在代码中多体现为函数</em></p>
<h3 id="Why-thread"><a href="#Why-thread" class="headerlink" title="Why  thread"></a>Why  thread</h3><p>线程生成的代价小，不必再开辟新的地址空间。</p>
<p>缺点：隔离性差，可能相互影响。</p>
<h3 id="Thread-internal-structure"><a href="#Thread-internal-structure" class="headerlink" title="Thread internal structure"></a>Thread internal structure</h3><p>thread共享地址空间但是有各自独立的栈</p>
<h3 id="Thread-Model"><a href="#Thread-Model" class="headerlink" title="Thread Model"></a>Thread Model</h3><p><em>了解即可</em></p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B.png" alt="线程模型"></p>
<h3 id="TCB-Thread-Control-Block"><a href="#TCB-Thread-Control-Block" class="headerlink" title="TCB(Thread Control Block)"></a>TCB(<em>Thread Control Block</em>)</h3><p><img src="http://r9d5zu5jl.bkt.clouddn.com/TCB.png" alt="TCB"></p>
<h3 id="Three-Implementation-way-重点"><a href="#Three-Implementation-way-重点" class="headerlink" title="*Three Implementation way(重点)"></a>*Three Implementation way(重点)</h3><p>​    1.in User Space: 会因为同一个进程中的一个线程的阻塞式系统调用引发其他线程的阻塞</p>
<p>​    2.in Kernel Space: 系统性能会差一点</p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/%E7%BA%BF%E7%A8%8B%E6%96%B9%E5%BC%8F.png" alt="线程方式"></p>
<p> 3.Hybird</p>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/Hydird.png" alt="Hybird"></p>
<h3 id="POSIX-Thread"><a href="#POSIX-Thread" class="headerlink" title="POSIX  Thread"></a>POSIX  Thread</h3><p>​    为了程序的可移植性</p>
<h3 id="Pop-Up-Thread"><a href="#Pop-Up-Thread" class="headerlink" title="Pop-Up Thread"></a>Pop-Up Thread</h3><p>​    the arrival of a message causes the system to create a new thread to handle the message. Such a thread is called a pop-up thread.</p>
<h2 id="IPC"><a href="#IPC" class="headerlink" title="IPC"></a>IPC</h2><h3 id="Race-Conditions"><a href="#Race-Conditions" class="headerlink" title="Race Conditions"></a>Race Conditions</h3><h4 id="critical-region"><a href="#critical-region" class="headerlink" title="critical region"></a>critical region</h4><p>​    Mutual Exclusion</p>
<p>​    i.e avoid two process access critical region at the same time</p>
<h5 id="what-is-critical-region"><a href="#what-is-critical-region" class="headerlink" title="what is critical region?"></a>what is critical region?</h5><p>​    The part of the program where the shared memory is accessed is called the critical region.</p>
<h5 id="To-solve-race-conditions-how-to-implement-it"><a href="#To-solve-race-conditions-how-to-implement-it" class="headerlink" title="To solve race conditions, how to implement it?"></a>To solve race conditions, how to implement it?</h5><ol>
<li>No two processes may be simultaneously inside their critical regions.</li>
<li>No assumptions may be made about speeds or the number of CPUs.</li>
<li>No process running outside its critical region may block any process.</li>
<li>No process should have to wait forever to enter its critical region.</li>
</ol>
<p><img src="http://r9d5zu5jl.bkt.clouddn.com/critical%20region.png"></p>
<h3 id="Mutual-Exclusion-with-Busy-Waiting"><a href="#Mutual-Exclusion-with-Busy-Waiting" class="headerlink" title="Mutual Exclusion with Busy Waiting"></a>Mutual Exclusion with Busy Waiting</h3><h4 id="Proposals-for-achieving-mutual-exclusion"><a href="#Proposals-for-achieving-mutual-exclusion" class="headerlink" title="Proposals for achieving mutual exclusion:"></a>Proposals for achieving mutual exclusion:</h4><p>​    Disabling interrupts</p>
<p>​    Lock variables</p>
<p>​        Strict alternation</p>
<p>​        Peterson’s solution</p>
<p>​        The TSL instruction</p>
<h4 id="Strict-Alternation"><a href="#Strict-Alternation" class="headerlink" title="Strict Alternation"></a>Strict Alternation</h4><p><img src="http://r9d5zu5jl.bkt.clouddn.com/%E4%B8%A5%E6%A0%BC%E4%BA%A4%E6%9B%BF.png" alt="严格交替"></p>
<h4 id="Peterson’s-solution"><a href="#Peterson’s-solution" class="headerlink" title="Peterson’s solution"></a>Peterson’s solution</h4><h4 id="TSL"><a href="#TSL" class="headerlink" title="TSL"></a>TSL</h4><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2022/03/26/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%94%E8%AE%B0/">← Next 面向对象程序设计笔记</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2022/03/25/%E8%AE%A1%E7%BB%84%E7%AC%94%E8%AE%B0/">计组笔记 Prev →</a></div></div></div><details id="reward"><summary>打赏</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details></div><div id="bottom-btn"><a id="to-top" onClick="index.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><div class="aside-box"><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Lilijiu</a></h1><div id="description"><p></p></div><!--if page.published === undefined--><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">4</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">2</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">0</span></div></section></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E7%BB%AA%E8%AE%BA"><span class="toc-number">1.</span> <span class="toc-text">一.绪论</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-PROCESSES-AND-THREADS"><span class="toc-number">2.</span> <span class="toc-text">二.PROCESSES    AND     THREADS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PROCESSES"><span class="toc-number">2.1.</span> <span class="toc-text">PROCESSES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Definition"><span class="toc-number">2.1.1.</span> <span class="toc-text">Definition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Internal-structure"><span class="toc-number">2.1.2.</span> <span class="toc-text">Internal structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Address-Space"><span class="toc-number">2.1.3.</span> <span class="toc-text">Address Space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PCB-Process-Control-Block"><span class="toc-number">2.1.4.</span> <span class="toc-text">PCB(Process Control Block)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">构造</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-Model"><span class="toc-number">2.1.5.</span> <span class="toc-text">Process Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-States"><span class="toc-number">2.1.6.</span> <span class="toc-text">Process States</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-Creation"><span class="toc-number">2.1.7.</span> <span class="toc-text">Process Creation</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#fork%E5%87%BD%E6%95%B0%E7%82%B9%E5%87%BB%E2%86%92fork%E2%86%90%E7%82%B9%E5%87%BB"><span class="toc-number">2.1.7.0.0.1.</span> <span class="toc-text">fork函数点击→fork←点击</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#excel%E5%87%BD%E6%95%B0exec%E6%97%8F%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-number">2.1.7.0.0.2.</span> <span class="toc-text">excel函数exec族函数详解</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-Termination"><span class="toc-number">2.1.8.</span> <span class="toc-text">Process Termination</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-Switching"><span class="toc-number">2.1.9.</span> <span class="toc-text">Process Switching</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-Performance-Measurement"><span class="toc-number">2.1.10.</span> <span class="toc-text">Process Performance Measurement</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thread"><span class="toc-number">2.2.</span> <span class="toc-text">Thread</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Definition-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">Definition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-thread"><span class="toc-number">2.2.2.</span> <span class="toc-text">Why  thread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread-internal-structure"><span class="toc-number">2.2.3.</span> <span class="toc-text">Thread internal structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thread-Model"><span class="toc-number">2.2.4.</span> <span class="toc-text">Thread Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCB-Thread-Control-Block"><span class="toc-number">2.2.5.</span> <span class="toc-text">TCB(Thread Control Block)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Three-Implementation-way-%E9%87%8D%E7%82%B9"><span class="toc-number">2.2.6.</span> <span class="toc-text">*Three Implementation way(重点)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#POSIX-Thread"><span class="toc-number">2.2.7.</span> <span class="toc-text">POSIX  Thread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pop-Up-Thread"><span class="toc-number">2.2.8.</span> <span class="toc-text">Pop-Up Thread</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPC"><span class="toc-number">2.3.</span> <span class="toc-text">IPC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Race-Conditions"><span class="toc-number">2.3.1.</span> <span class="toc-text">Race Conditions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#critical-region"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">critical region</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#what-is-critical-region"><span class="toc-number">2.3.1.1.1.</span> <span class="toc-text">what is critical region?</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#To-solve-race-conditions-how-to-implement-it"><span class="toc-number">2.3.1.1.2.</span> <span class="toc-text">To solve race conditions, how to implement it?</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mutual-Exclusion-with-Busy-Waiting"><span class="toc-number">2.3.2.</span> <span class="toc-text">Mutual Exclusion with Busy Waiting</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Proposals-for-achieving-mutual-exclusion"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">Proposals for achieving mutual exclusion:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Strict-Alternation"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">Strict Alternation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Peterson%E2%80%99s-solution"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">Peterson’s solution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TSL"><span class="toc-number">2.3.2.4.</span> <span class="toc-text">TSL</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><footer><nobr><span class="text-title">©</span><span class="text-content">2020-???</span></nobr><br><nobr><span class="text-title">ICP</span><span class="text-content">备案？备个屁！</span></nobr><br><text>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></text><text> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></text><wbr><text>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></text></footer></aside></div></main><canvas id="canvas-dust"></canvas><script>const reset=_=>{}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>document.addEventListener("load",reset())</script></body></html>